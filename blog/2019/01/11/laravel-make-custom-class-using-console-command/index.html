<!DOCTYPE html>
<html>
    <head lang="en">
        <title>Laravel make custom class using console command &mdash; Tech.Semicolon</title>
        <meta charset="utf-8">
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
            <meta name="robots" content="index, follow">

        <!-- Meta Tags -->
        <meta name="description" content="Know how you can make custom class from console command. This will eventually save your time and give more uniformity of similar classes across the project." />
        <meta property="og:title" content="Laravel make custom class using console command" />
        <meta property="og:type" content="article" />
        <meta property="og:url" content="https://techsemicolon.github.io" />
        <meta property="og:image" content="https://techsemicolon.github.io/images/logo.png" />
        <meta property="og:description" content="Know how you can make custom class from console command. This will eventually save your time and give more uniformity of similar classes across the project." /> 
        <meta property="og:site_name" content="Tech Semicolon" />
    
        <link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i,900,900i&display=swap" rel="stylesheet">
        <link href="https://techsemicolon.github.io/components/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
        <link href="https://techsemicolon.github.io/css/style.css" rel="stylesheet" type="text/css" />

        <link rel="apple-touch-startup-image" href="https://techsemicolon.github.io/images/fav.png">
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <link rel="shortcut icon" sizes="76x76" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="shortcut icon" sizes="120x120" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="shortcut icon" sizes="128x128" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="shortcut icon" sizes="152x152" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="shortcut icon" sizes="196x196" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="shortcut icon" sizes="512x512" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="shortcut icon" sizes="1024x1024" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="shortcut icon" sizes="2048x2048" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="apple-touch-icon" sizes="76x76" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="apple-touch-icon" sizes="120x120" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="apple-touch-icon" sizes="128x128" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="apple-touch-icon" sizes="152x152" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="apple-touch-icon" sizes="196x196" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="apple-touch-icon" sizes="512x512" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="apple-touch-icon" sizes="1024x1024" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="apple-touch-icon" sizes="2048x2048" href="https://techsemicolon.github.io/images/fav.png">

        <link rel="stylesheet" href="https://techsemicolon.github.io/components/highlightjs/styles/github.css" />
        <link rel="alternate" type="application/atom+xml" href="https://techsemicolon.github.io/atom.xml" title="Tech.Semicolon activity feed" />
                    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
            <script>
            (adsbygoogle = window.adsbygoogle || []).push({
                google_ad_client: "ca-pub-6453469589570319",
                enable_page_level_ads: true
            });
            </script>
                                            </head>
    <body>
        <div id="fb-root"></div>
        <script>(function(d, s, id) {
              var js, fjs = d.getElementsByTagName(s)[0];
              if (d.getElementById(id)) return;
              js = d.createElement(s); js.id = id;
              js.src = 'https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.2&appId=1919280101503437&autoLogAppEvents=1';
              fjs.parentNode.insertBefore(js, fjs);
            }(document, 'script', 'facebook-jssdk'));
        </script>
        <header>
            <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-header">
                <div class="container">
                    <a class="navbar-brand" href="https://techsemicolon.github.io/">
                        <img src="https://techsemicolon.github.io/images/logo.png" class="logo-img"/>
                    </a>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarCollapse">
                        <ul class="navbar-nav mr-auto">
                            <li class="nav-item"><a class="nav-link" href="https://techsemicolon.github.io/blog">Posts Archive</a></li>
                            <li class="nav-item"><a class="nav-link" href="https://techsemicolon.github.io/blog/categories">Categories</a></li>
                            <li class="nav-item"><a class="nav-link" href="https://techsemicolon.github.io/blog/tags">Tags</a></li>
                            <li class="nav-item"><a target="_blank" class="nav-link" href="https://github.com/techsemicolon">GitHub</a></li>
                            <li class="nav-item"><a class="nav-link" href="https://techsemicolon.github.io/about">About</a></li>
                        </ul>
                    </div>
                </div>
            </nav>
        </header>
        <main role="main" class="container">
            <div class="row">
                <div class="col-sm-12">
                        <article>
        <header>
            <h2>Laravel make custom class using console command</h2>
        </header>
        <div class="row">
            <div class="col-sm-10 col-md-10 col-xs-12">
                <p>Laravel ships with built in console <code>make</code> commands to generate class files for controllers, models, migrations etc. For example creating a resourse controller, you can do :</p>

<pre><code class="bash">php artisan make:controller CustomerController --resource
</code></pre>

<p>Depending in your project structure and design patterns, you might be using different classes like repositories, services etc. We can take advantage of console commands to save time and create it just like we created controller above.</p>

<h3 id="file-generation-%3A">File generation :</h3>

<p>We firstly create a template file which is like a blueprint of how thw new class file will look like. This file is called <code>stub</code> file.</p>

<p>Then when command is run, we simply copy the stub to <code>class.php</code> and replace the dummyclass, dummynamespace etc with the new files class and namespace.</p>

<p>Above steps are made much simpler by <code>GeneratorCommand</code> class.</p>

<h3 id="the-generatorcommand-class-%3A">The GeneratorCommand class :</h3>

<p>Laravel's make commands extend an abstract class <code>GeneratorCommand</code>. This class basically has all the methods which do making a directory, getting content of stub, replacing class &amp; namespace, saving the new file and so on.</p>

<p>This is an abstract class which then extends the Illuminate <code>command</code> class.</p>

<h3 id="example-%3A">Example :</h3>

<p>Let's create a make command for generating <code>Repository</code> for a model.</p>

<ul>
<li>Create the stub :</li>
</ul>

<p>Create a directory called <code>stubs</code> in laravel project root. I really like non-php files outside the app folder, you can put the stubs in the location you prefer.</p>

<p>Create a new file inside <code>stubs</code> directory called <code>Repository.stub</code>. We are eliminating the repository specific functions as the goal is to focus on creating class file. You can add your repository functions inside the stub or maybe create a base class and extend stubs class from it.</p>

<pre><code class="php">&lt;?php

namespace DummyNamespace;

use App\DummyModel;

class DummyRepository
{
    protected $model;
    /**
       * Instantiate reporitory
       * 
       * @param DummyModel $model
       */
    public function __construct(DummyModel $model)
    {
        $this-&gt;model = $model;
    }

    // Your methods for repository
}
</code></pre>

<p>The usual idea is whatever is to be replaced, we prefix it with <code>Dummy</code>.</p>

<ul>
<li>Creating command :</li>
</ul>

<p>Let's create command scaffolding from artisan :</p>

<pre><code class="bash">php artisan make:command RepositoryMakeCommand
</code></pre>

<p>The make command classes are generally named in format <code>WhatToCreateMakeCommand</code>. If we had to create a service class, we could say <code>ServiceMakeCommand</code>.</p>

<p>We need to edit the <code>RepositoryMakeCommand.php</code> file which will be generated inside <code>app/Console/Commands</code> folder.</p>

<pre><code class="php">&lt;?php

namespace App\Console\Commands;

use Illuminate\Console\GeneratorCommand;
use Symfony\Component\Console\Input\InputArgument;
use Symfony\Component\Console\Exception\InvalidArgumentException;

class RepositoryMakeCommand extends GeneratorCommand
{
    /**
     * The name and signature of the console command.
     *
     * @var string
     */
    protected $name = 'make:repository';

    /**
     * The console command description.
     *
     * @var string
     */
    protected $description = 'Create a new model repository';

    /**
     * The type of class being generated.
     *
     * @var string
     */
    protected $type = 'Repository';

    /**
     * The name of class being generated.
     *
     * @var string
     */
    private $repositoryClass;

    /**
     * The name of class being generated.
     *
     * @var string
     */
    private $model;

    /**
     * Execute the console command.
     *
     * @return bool|null
     */
    public function fire(){

        $this-&gt;setRepositoryClass();

        $path = $this-&gt;getPath($this-&gt;repositoryClass);

        if ($this-&gt;alreadyExists($this-&gt;getNameInput())) {
            $this-&gt;error($this-&gt;type.' already exists!');

            return false;
        }

        $this-&gt;makeDirectory($path);

        $this-&gt;files-&gt;put($path, $this-&gt;buildClass($this-&gt;repositoryClass));

        $this-&gt;info($this-&gt;type.' created successfully.');

        $this-&gt;line("&lt;info&gt;Created Repository :&lt;/info&gt; $this-&gt;repositoryClass");
    }

    /**
     * Set repository class name
     *
     * @return  void
     */
    private function setRepositoryClass()
    {
        $name = ucwords(strtolower($this-&gt;argument('name')));

        $this-&gt;model = $name;

        $modelClass = $this-&gt;parseName($name);

        $this-&gt;repositoryClass = $modelClass . 'Repository';

        return $this;
    }

    /**
     * Replace the class name for the given stub.
     *
     * @param  string  $stub
     * @param  string  $name
     * @return string
     */
    protected function replaceClass($stub, $name)
    {
        if(!$this-&gt;argument('name')){
            throw new InvalidArgumentException("Missing required argument model name");
        }

        $stub = parent::replaceClass($stub, $name);

        return str_replace('DummyModel', $this-&gt;model, $stub);
    }

    /**
     * 
     * Get the stub file for the generator.
     *
     * @return string
     */
    protected function getStub()
    {
        return  base_path('stubs/Repository.stub');
    }
    /**
     * Get the default namespace for the class.
     *
     * @param  string  $rootNamespace
     * @return string
     */
    protected function getDefaultNamespace($rootNamespace)
    {
        return $rootNamespace . '\Repo';
    }

    /**
     * Get the console command arguments.
     *
     * @return array
     */
    protected function getArguments()
    {
        return [
            ['name', InputArgument::REQUIRED, 'The name of the model class.'],
        ];
    }
}
</code></pre>

<ul>
<li>Registering the command :</li>
</ul>

<p>Finally we need to register this command to make available in artisan console. We can do that by adding it inside <code>app/Console/Kernel.php</code>.</p>

<p>Inside <code>protected $commands = []</code> array add the class path :</p>

<pre><code class="php">\App\Console\Commands\RepositoryMakeCommand::class,
</code></pre>

<ul>
<li>Using the command :</li>
</ul>

<pre><code class="bash">php artisan make:repository Customer
</code></pre>

<p>This will create a <code>CustomerRepository.php</code> inside <code>app/Repo</code> folder :</p>

<pre><code class="php">&lt;?php

namespace App\Repo;

use App\Customer;

class CustomerRepository
{
    protected $model;
    /**
       * Instantiate reporitory
       * 
       * @param Customer $model
       */
    public function __construct(Customer $model)
    {
        $this-&gt;model = $model;
    }

    // Your methods for repository
}
</code></pre>

<p>You can extend this implementation as per your project structure needs. This indeed saves time in longer run and makes sure all generated classes have common blueprint structure.</p>

            </div>
                            <div class="col-sm-2 col-md-2 col-xs-12">
                    <ins class="adsbygoogle"
                        style="display:block"
                        data-ad-client="ca-pub-6453469589570319"
                        data-ad-slot="8792586132"
                        data-ad-format="auto"
                        data-full-width-responsive="true"></ins>
                <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
                <div class="ad-gap">&nbsp;</div>
                <ins class="adsbygoogle"
                        style="display:block"
                        data-ad-client="ca-pub-6453469589570319"
                        data-ad-slot="8792586132"
                        data-ad-format="auto"
                        data-full-width-responsive="true"></ins>
                    <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
                    <div class="ad-gap">&nbsp;</div>
                    <ins class="adsbygoogle"
                            style="display:block"
                            data-ad-client="ca-pub-6453469589570319"
                            data-ad-slot="8792586132"
                            data-ad-format="auto"
                            data-full-width-responsive="true"></ins>
                    <script>
                            (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
                </div>
                    </div>
                    <ins class="adsbygoogle"
                style="display:block"
                data-ad-client="ca-pub-6453469589570319"
                data-ad-slot="6593798201"
                data-ad-format="auto"
                data-full-width-responsive="true"></ins>
            <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        
                <div class="cat-tags">
            <span class="tags col-md-6">By : Mihir Bhende</span>
                            <span class="categories col-md-6">
                Categories : 
                                <a href="https://techsemicolon.github.io/blog/categories/laravel">laravel</a>,                                 <a href="https://techsemicolon.github.io/blog/categories/php">php</a>                                </span>
                                        <span class="tags col-md-6">
                Tags : 
                                <a href="https://techsemicolon.github.io/blog/tags/laravel">laravel</a>,                                 <a href="https://techsemicolon.github.io/blog/tags/php">php</a>,                                 <a href="https://techsemicolon.github.io/blog/tags/helpers">helpers</a>,                                 <a href="https://techsemicolon.github.io/blog/tags/collections">collections</a>                                </span>
                    </div>

        <div class="fb-comments" 
            data-href="https://techsemicolon.github.io" 
            data-numposts="5" width="100%">
        </div>
    </article>



                </div>
            </div>
        </main>
        <footer class="container">
            <span>Tech.Semicolon | &copy; 2019 </span>
        </footer>

        <script src="https://techsemicolon.github.io/components/jquery/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
        <script src="https://techsemicolon.github.io/components/bootstrap/js/bootstrap.min.js"></script>
                
                <script src="https://techsemicolon.github.io/components/highlightjs/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>

                    </body>
</html>
