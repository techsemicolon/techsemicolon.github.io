<!DOCTYPE html>
<html>
    <head lang="en">
        <title>PHP argument validation using assert &mdash; Tech.Semicolon</title>
        <meta charset="utf-8">
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
            <meta name="robots" content="index, follow">

        <!-- Meta Tags -->
        <meta name="description" content="Know how you can easily validate method parameters without writing too much code. Exploring more about assert functions." />
        <meta property="og:title" content="PHP argument validation using assert" />
        <meta property="og:type" content="article" />
        <meta property="og:url" content="https://techsemicolon.github.io" />
        <meta property="og:image" content="https://techsemicolon.github.io/images/logo.png" />
        <meta property="og:description" content="Know how you can easily validate method parameters without writing too much code. Exploring more about assert functions." /> 
        <meta property="og:site_name" content="Tech Semicolon" />
    
        <link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i,900,900i&display=swap" rel="stylesheet">
        <link href="https://techsemicolon.github.io/components/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
        <link href="https://techsemicolon.github.io/css/style.css" rel="stylesheet" type="text/css" />

        <link rel="apple-touch-startup-image" href="https://techsemicolon.github.io/images/fav.png">
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <link rel="shortcut icon" sizes="76x76" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="shortcut icon" sizes="120x120" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="shortcut icon" sizes="128x128" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="shortcut icon" sizes="152x152" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="shortcut icon" sizes="196x196" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="shortcut icon" sizes="512x512" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="shortcut icon" sizes="1024x1024" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="shortcut icon" sizes="2048x2048" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="apple-touch-icon" sizes="76x76" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="apple-touch-icon" sizes="120x120" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="apple-touch-icon" sizes="128x128" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="apple-touch-icon" sizes="152x152" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="apple-touch-icon" sizes="196x196" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="apple-touch-icon" sizes="512x512" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="apple-touch-icon" sizes="1024x1024" href="https://techsemicolon.github.io/images/fav.png">
        <link rel="apple-touch-icon" sizes="2048x2048" href="https://techsemicolon.github.io/images/fav.png">

        <link rel="stylesheet" href="https://techsemicolon.github.io/components/highlightjs/styles/github.css" />
        <link rel="alternate" type="application/atom+xml" href="https://techsemicolon.github.io/atom.xml" title="Tech.Semicolon activity feed" />
                    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
            <script>
            (adsbygoogle = window.adsbygoogle || []).push({
                google_ad_client: "ca-pub-6453469589570319",
                enable_page_level_ads: true
            });
            </script>
                                            </head>
    <body>
        <div id="fb-root"></div>
        <script>(function(d, s, id) {
              var js, fjs = d.getElementsByTagName(s)[0];
              if (d.getElementById(id)) return;
              js = d.createElement(s); js.id = id;
              js.src = 'https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.2&appId=1919280101503437&autoLogAppEvents=1';
              fjs.parentNode.insertBefore(js, fjs);
            }(document, 'script', 'facebook-jssdk'));
        </script>
        <header>
            <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-header">
                <div class="container">
                    <a class="navbar-brand" href="https://techsemicolon.github.io/">
                        <img src="https://techsemicolon.github.io/images/logo.png" class="logo-img"/>
                    </a>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarCollapse">
                        <ul class="navbar-nav mr-auto">
                            <li class="nav-item"><a class="nav-link" href="https://techsemicolon.github.io/blog">Posts Archive</a></li>
                            <li class="nav-item"><a class="nav-link" href="https://techsemicolon.github.io/blog/categories">Categories</a></li>
                            <li class="nav-item"><a class="nav-link" href="https://techsemicolon.github.io/blog/tags">Tags</a></li>
                            <li class="nav-item"><a target="_blank" class="nav-link" href="https://github.com/techsemicolon">GitHub</a></li>
                            <li class="nav-item"><a class="nav-link" href="https://techsemicolon.github.io/about">About</a></li>
                        </ul>
                    </div>
                </div>
            </nav>
        </header>
        <main role="main" class="container">
            <div class="row">
                <div class="col-sm-12">
                        <article>
        <header>
            <h2>PHP argument validation using assert</h2>
        </header>
        <div class="row">
            <div class="col-sm-10 col-md-10 col-xs-12">
                <p>When creating classes, we either pass arguments to the constructor function or have setter-getter functions to access class properties. These arguments may sometime have a specific format or requirements. For Example :</p>

<pre><code class="php">/**
 * $age integer
 *
 * @return  string
 */
function($age){
    return "You are $age years old";
}
</code></pre>

<p>Above function expects $age to be an integer. If any other type is passed, function will no work as expected.</p>

<p>The example was very granular. When your core classes have functions which affect important domain logics of your project, argument validation becomes an  important part.</p>

<p>PHP comes with default function(or more specifically a language construct for PHP version 7) called <a href="http://php.net/manual/en/function.assert.php"><code>assert</code></a>, which basically checks if provided assertion if false. If yes then you can handle the exceptions in callback. Even if this is useful, I will strongly suggest using composer plugin <a href="https://github.com/webmozart/assert">webmozart/assert</a> for this. It has very useful intuitive methods for the same.</p>

<ul>
<li>Example :</li>
</ul>

<p>Let's consider a function <code>placeOrder()</code> which takes array of <code>$items</code> having instances of <code>Item</code> class, a <code>$shippingPrice</code> and <code>$customer</code> having instance of <code>Customer</code> class.</p>

<pre><code class="php">&lt;?php 

use Webmozart\Assert\Assert;

Class Order{

    /**
     * Array of Item instances
     * @var array
     */
    private $items;

    /**
     * Shipping Price
     * @var float
     */
    private $shippingPrice;

    /**
     * Customer Instance
     * @var Customer
     */
    private $customer;

    /**
     * Instantiate Order class
     * 
     * @param $items
     * @param $shippingPrice
     * @param $customer
     */
    function __construct($items, $shippingPrice, $customer)
    {
        Assert::isArray($items, '$items must be an array. Got: %s');
        Assert::allIsInstanceOf($items, '\Item', '$items must contain array of Item class instances. Got: %s');
        Assert::numeric($shippingPrice, '$shippingPrice must be numeric. Got: %s');
        Assert::isInstanceOf($customer, '\Customer', '$customer must be an instance of Customer class. Got: %s');

        $this-&gt;shippingPrice    = $shippingPrice;
        $this-&gt;customer         = $customer;
        $this-&gt;items            = $items;
    }

    /**
     * Places order
     * 
     * @return Order
     */
    public function placeOrder(){

        // PlaceOrder
    }
}
</code></pre>

<p>Now, when we instantiate the order class :</p>

<pre><code class="php">$customer = new Customer('John Doe');

$order = new Order([], 12.22, $customer);
</code></pre>

<p>We are passing an invalid value for <code>$items</code> argument. It will throw <code>\InvalidArgumentException</code> with error message : <code>$items must contain array of Item class instances. Got: Array</code>.</p>

<p>If you are using setter-getter functions instead of constructor parameters, you can have these assertions inside the setter functions. Above methodology is sometimes referred as defensive programming where we are making sure function will not break at the intial stages itself. The counter concept of defensive programming will be validating these arguments as and when they are actually used inside <code>placeOrder</code> function.</p>

<p>Advantages :</p>

<ol>
<li>Prevents errors caused due to unexpected type of arguments passed</li>
<li>Easier to debug</li>
<li>Easier to create unit tests and catch asset exceptions</li>
<li>Easier to write readable custom error messages</li>
</ol>

<p>Disadvantages :</p>

<p>If not properly thought, duplicate validations can cause redundancies. For example in above case, if instance of <code>Item</code> class contains a valid price is a concern of <code>Item</code> class. If that validation is also present in <code>Order</code> class as well, it created redundancies.</p>

<p>You can find more assertion options available here : <a href="https://github.com/webmozart/assert">https://github.com/webmozart/assert</a></p>

            </div>
                            <div class="col-sm-2 col-md-2 col-xs-12">
                    <ins class="adsbygoogle"
                        style="display:block"
                        data-ad-client="ca-pub-6453469589570319"
                        data-ad-slot="8792586132"
                        data-ad-format="auto"
                        data-full-width-responsive="true"></ins>
                <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
                <div class="ad-gap">&nbsp;</div>
                <ins class="adsbygoogle"
                        style="display:block"
                        data-ad-client="ca-pub-6453469589570319"
                        data-ad-slot="8792586132"
                        data-ad-format="auto"
                        data-full-width-responsive="true"></ins>
                    <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
                    <div class="ad-gap">&nbsp;</div>
                    <ins class="adsbygoogle"
                            style="display:block"
                            data-ad-client="ca-pub-6453469589570319"
                            data-ad-slot="8792586132"
                            data-ad-format="auto"
                            data-full-width-responsive="true"></ins>
                    <script>
                            (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
                </div>
                    </div>
                    <ins class="adsbygoogle"
                style="display:block"
                data-ad-client="ca-pub-6453469589570319"
                data-ad-slot="6593798201"
                data-ad-format="auto"
                data-full-width-responsive="true"></ins>
            <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        
                <div class="cat-tags">
            <span class="tags col-md-6">By : Mihir Bhende</span>
                            <span class="categories col-md-6">
                Categories : 
                                <a href="https://techsemicolon.github.io/blog/categories/laravel">laravel</a>,                                 <a href="https://techsemicolon.github.io/blog/categories/php">php</a>                                </span>
                                        <span class="tags col-md-6">
                Tags : 
                                <a href="https://techsemicolon.github.io/blog/tags/laravel">laravel</a>,                                 <a href="https://techsemicolon.github.io/blog/tags/php">php</a>,                                 <a href="https://techsemicolon.github.io/blog/tags/validation">validation</a>,                                 <a href="https://techsemicolon.github.io/blog/tags/arguments">arguments</a>,                                 <a href="https://techsemicolon.github.io/blog/tags/assert">assert</a>                                </span>
                    </div>

        <div class="fb-comments" 
            data-href="https://techsemicolon.github.io" 
            data-numposts="5" width="100%">
        </div>
    </article>



                </div>
            </div>
        </main>
        <footer class="container">
            <span>Tech.Semicolon | &copy; 2020 </span>
        </footer>

        <script src="https://techsemicolon.github.io/components/jquery/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
        <script src="https://techsemicolon.github.io/components/bootstrap/js/bootstrap.min.js"></script>
                
                <script src="https://techsemicolon.github.io/components/highlightjs/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>

                    </body>
</html>
